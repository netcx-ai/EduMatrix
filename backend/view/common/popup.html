<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>{block name="title"}弹窗页面{/block}</title>
    <link rel="stylesheet" href="/static/layui/css/layui.css">
    <link rel="stylesheet" href="/static/admin/css/admin.css">
    <style>
    /* 弹窗页面专用样式 */
    body {
        background-color: #f2f2f2;
        padding: 15px;
        margin: 0;
    }
    
    .popup-container {
        background-color: #fff;
        border-radius: 4px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        padding: 20px;
        min-height: calc(100vh - 30px);
    }
    
    .popup-header {
        border-bottom: 1px solid #e6e6e6;
        padding-bottom: 15px;
        margin-bottom: 20px;
    }
    
    .popup-title {
        font-size: 18px;
        font-weight: bold;
        color: #333;
        margin: 0;
    }
    
    .popup-content {
        padding: 0;
    }
    
    /* 表格样式优化 */
    .layui-table {
        margin-top: 10px;
    }
    
    /* 搜索表单样式 */
    .layui-form-pane {
        background-color: #f8f8f8;
        padding: 15px;
        border-radius: 4px;
        margin-bottom: 15px;
    }
    
    /* 按钮组样式 */
    .layui-btn-group {
        margin-bottom: 10px;
    }
    </style>
    {block name="style"}{/block}
</head>
<body>
    <div class="popup-container">
        <div class="popup-header">
            <h2 class="popup-title">{block name="page_title"}页面标题{/block}</h2>
        </div>
        <div class="popup-content">
            {block name="content"}{/block}
        </div>
    </div>
    
    <script src="/static/admin/js/jquery-3.7.1.min.js"></script>
    <script src="/static/layui/layui.js"></script>
    <script>
    // 弹窗页面专用脚本
    layui.use(['layer'], function(){
        var layer = layui.layer;
        
        // 全局Ajax设置 - 处理登录超时
        $.ajaxSetup({
            complete: function(xhr, status) {
                // 检查响应状态码
                if (xhr.status === 401) {
                    // 未授权，跳转到登录页面
                    layer.msg('登录已过期，请重新登录', {icon: 2, time: 2000}, function(){
                        window.location.href = '/admin/login';
                    });
                    return;
                }
                
                // 检查响应内容中的错误信息
                try {
                    var response = JSON.parse(xhr.responseText);
                    if (response.code === 401 || response.message === '请登录' || response.msg === '请登录') {
                        layer.msg('登录已过期，请重新登录', {icon: 2, time: 2000}, function(){
                            window.location.href = '/admin/login';
                        });
                        return;
                    }
                } catch (e) {
                    // 解析JSON失败，忽略
                }
            }
        });
    });
    </script>
    {block name="script"}{/block}
</body>
</html> 