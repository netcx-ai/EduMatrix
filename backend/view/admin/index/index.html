{extend name="common/base" /}

{block name="content"}
<div class="layui-fluid">
    <!-- 统计卡片 -->
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md3">
            <div class="layui-card">
                <div class="layui-card-header">
                    <i class="layui-icon layui-icon-user" style="color: #1E9FFF;"></i>
                    管理员数量
                </div>
                <div class="layui-card-body">
                    <h2>{$stats.admin_count}</h2>
                </div>
            </div>
        </div>
        <div class="layui-col-md3">
            <div class="layui-card">
                <div class="layui-card-header">
                    <i class="layui-icon layui-icon-friends" style="color: #5FB878;"></i>
                    用户数量
                </div>
                <div class="layui-card-body">
                    <h2>{$stats.user_count}</h2>
                </div>
            </div>
        </div>
        <div class="layui-col-md3">
            <div class="layui-card">
                <div class="layui-card-header">
                    <i class="layui-icon layui-icon-file" style="color: #FFB800;"></i>
                    文章数量
                </div>
                <div class="layui-card-body">
                    <h2>{$stats.article_count}</h2>
                </div>
            </div>
        </div>
        <div class="layui-col-md3">
            <div class="layui-card">
                <div class="layui-card-header">
                    <i class="layui-icon layui-icon-tabs" style="color: #FF5722;"></i>
                    分类数量
                </div>
                <div class="layui-card-body">
                    <h2>{$stats.category_count}</h2>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 系统信息和状态 -->
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md6">
            <div class="layui-card">
                <div class="layui-card-header">系统信息</div>
                <div class="layui-card-body">
                    <table class="layui-table" lay-skin="line">
                        <tbody>
                            <tr>
                                <td>平台名称</td>
                                <td>{$systemInfo.site_name}</td>
                            </tr>
                            <tr>
                                <td>系统版本</td>
                                <td>{$systemInfo.version}</td>
                            </tr>
                            <tr>
                                <td>时区设置</td>
                                <td>{$systemInfo.timezone}</td>
                            </tr>
                            <tr>
                                <td>默认语言</td>
                                <td>{$systemInfo.language}</td>
                            </tr>
                            <tr>
                                <td>维护模式</td>
                                <td>
                                    {if $systemStatus.maintenance_mode}
                                    <span class="layui-badge layui-bg-orange">已开启</span>
                                    {else}
                                    <span class="layui-badge layui-bg-green">已关闭</span>
                                    {/if}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="layui-col-md6">
            <div class="layui-card">
                <div class="layui-card-header">系统状态</div>
                <div class="layui-card-body">
                    <table class="layui-table" lay-skin="line">
                        <tbody>
                            <tr>
                                <td>数据库状态</td>
                                <td>
                                    {if $systemStatus.database_status}
                                    <span class="layui-badge layui-bg-green">正常</span>
                                    {else}
                                    <span class="layui-badge">异常</span>
                                    {/if}
                                </td>
                            </tr>
                            <tr>
                                <td>缓存状态</td>
                                <td>
                                    {if $systemStatus.cache_status}
                                    <span class="layui-badge layui-bg-green">正常</span>
                                    {else}
                                    <span class="layui-badge">异常</span>
                                    {/if}
                                </td>
                            </tr>
                            <tr>
                                <td>磁盘使用</td>
                                <td>
                                    <div class="layui-progress layui-progress-big" lay-showpercent="true">
                                        <div class="layui-progress-bar" lay-percent="{$systemStatus.disk_usage.percent}%"></div>
                                    </div>
                                    <small>{$systemStatus.disk_usage.used} / {$systemStatus.disk_usage.total}</small>
                                </td>
                            </tr>
                            <tr>
                                <td>内存使用</td>
                                <td>
                                    当前: {$systemStatus.memory_usage.current} | 峰值: {$systemStatus.memory_usage.peak}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 访问统计和最近登录 -->
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md6">
            <div class="layui-card">
                <div class="layui-card-header">访问统计</div>
                <div class="layui-card-body">
                    <div class="layui-row">
                        <div class="layui-col-md6">
                            <div class="stat-item">
                                <div class="stat-number">{$stats.today_visits}</div>
                                <div class="stat-label">今日访问</div>
                            </div>
                        </div>
                        <div class="layui-col-md6">
                            <div class="stat-item">
                                <div class="stat-number">{$stats.month_visits}</div>
                                <div class="stat-label">本月访问</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="layui-col-md6">
            <div class="layui-card">
                <div class="layui-card-header">最近登录</div>
                <div class="layui-card-body">
                    {if $recentLogins}
                    <table class="layui-table" lay-skin="line">
                        <thead>
                            <tr>
                                <th>管理员</th>
                                <th>IP地址</th>
                                <th>登录时间</th>
                            </tr>
                        </thead>
                        <tbody>
                            {foreach $recentLogins as $login}
                            <tr>
                                <td>{$login.admin_name|default='未知'}</td>
                                <td>{$login.ip}</td>
                                <td>{$login.create_time|date='m-d H:i'}</td>
                            </tr>
                            {/foreach}
                        </tbody>
                    </table>
                    {else}
                    <div class="layui-text" style="text-align: center; color: #999; padding: 20px;">
                        暂无登录记录
                    </div>
                    {/if}
                </div>
            </div>
        </div>
    </div>
    
    <!-- 快捷操作 -->
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">快捷操作</div>
                <div class="layui-card-body">
                    <a href="/admin/system_setting/index" class="layui-btn layui-btn-normal">
                        <i class="layui-icon layui-icon-set"></i> 系统设置
                    </a>
                    <a href="/admin/system_config/index" class="layui-btn layui-btn-primary">
                        <i class="layui-icon layui-icon-console"></i> 系统配置
                    </a>
                    <a href="/admin/admin/index" class="layui-btn layui-btn-primary">
                        <i class="layui-icon layui-icon-user"></i> 管理员管理
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{/block}

{block name="style"}
<style>
.stat-item {
    text-align: center;
    padding: 20px;
}
.stat-number {
    font-size: 24px;
    font-weight: bold;
    color: #1E9FFF;
}
.stat-label {
    margin-top: 5px;
    color: #666;
}
.layui-card-header i {
    margin-right: 5px;
}
</style>
{/block}

{block name="script"}
<script>
layui.use(['element', 'layer'], function(){
    var element = layui.element;
    var layer = layui.layer;
});
</script>
{/block} 