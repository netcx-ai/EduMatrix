<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>学校详情</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="/static/layui/css/layui.css" media="all">
</head>
<body style="padding: 15px;">
    <div class="layui-row layui-col-space15">
        <!-- 学校基本信息 -->
        <div class="layui-col-md8">
            <div class="layui-card">
                <div class="layui-card-header">
                    <span class="layui-badge layui-bg-blue">学校基本信息</span>
                </div>
                <div class="layui-card-body">
                    <div class="layui-row">
                        <div class="layui-col-md6">
                            <table class="layui-table" lay-skin="nob">
                                <colgroup>
                                    <col width="120">
                                    <col>
                                </colgroup>
                                <tbody>
                                    <tr>
                                        <td><strong>学校名称：</strong></td>
                                        <td id="schoolName">{$school.name|default='-'}</td>
                                    </tr>
                                    <tr>
                                        <td><strong>学校代码：</strong></td>
                                        <td id="schoolCode">{$school.code|default='-'}</td>
                                    </tr>
                                    <tr>
                                        <td><strong>联系人：</strong></td>
                                        <td id="contact">{$school.contact|default='-'}</td>
                                    </tr>
                                    <tr>
                                        <td><strong>联系电话：</strong></td>
                                        <td id="phone">{$school.phone|default='-'}</td>
                                    </tr>
                                    <tr>
                                        <td><strong>邮箱：</strong></td>
                                        <td id="email">{$school.email|default='-'}</td>
                                    </tr>
                                    <tr>
                                        <td><strong>地址：</strong></td>
                                        <td id="address">{$school.address|default='-'}</td>
                                    </tr>
                                    <tr>
                                        <td><strong>状态：</strong></td>
                                        <td id="status">
                                            {switch $school.status}
                                                {case active}<span class="layui-badge layui-bg-green">正常</span>{/case}
                                                {case pending}<span class="layui-badge layui-bg-orange">待审核</span>{/case}
                                                {case suspended}<span class="layui-badge layui-bg-gray">已停用</span>{/case}
                                                {else/}<span class="layui-badge layui-bg-gray">未知</span>
                                            {/switch}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>创建时间：</strong></td>
                                        <td id="createTime">{$school.create_time|default='-'}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="layui-col-md6">
                            <div class="layui-form-item layui-form-text">
                                <label><strong>学校简介：</strong></label>
                                <div id="description" style="padding: 10px; background-color: #f8f8f8; border-radius: 4px; min-height: 100px;">
                                    {$school.description|default='暂无简介'}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 统计信息 -->
        <div class="layui-col-md4">
            <div class="layui-card">
                <div class="layui-card-header">
                    <span class="layui-badge layui-bg-green">统计信息</span>
                </div>
                <div class="layui-card-body">
                    <div class="layui-row layui-col-space10">
                        <div class="layui-col-md6">
                            <div class="layui-bg-blue" style="padding: 20px; text-align: center; border-radius: 4px; color: white;">
                                <h2>{$stats.college_count|default=0}</h2>
                                <p>学院数量</p>
                            </div>
                        </div>
                        <div class="layui-col-md6">
                            <div class="layui-bg-green" style="padding: 20px; text-align: center; border-radius: 4px; color: white;">
                                <h2>{$stats.teacher_count|default=0}</h2>
                                <p>教师数量</p>
                            </div>
                        </div>
                        <div class="layui-col-md6">
                            <div class="layui-bg-orange" style="padding: 20px; text-align: center; border-radius: 4px; color: white;">
                                <h2>{$stats.course_count|default=0}</h2>
                                <p>课程数量</p>
                            </div>
                        </div>
                        <div class="layui-col-md6">
                            <div class="layui-bg-purple" style="padding: 20px; text-align: center; border-radius: 4px; color: white;">
                                <h2>{$stats.student_count|default=0}</h2>
                                <p>学生数量</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 学院列表 -->
    <div class="layui-card">
        <div class="layui-card-header">
            <span class="layui-badge layui-bg-orange">学院列表</span>
        </div>
        <div class="layui-card-body">
            <table id="collegeTable" lay-filter="collegeTable"></table>
        </div>
    </div>

    <!-- 教师列表 -->
    <div class="layui-card">
        <div class="layui-card-header">
            <span class="layui-badge layui-bg-purple">教师列表</span>
        </div>
        <div class="layui-card-body">
            <table id="teacherTable" lay-filter="teacherTable"></table>
        </div>
    </div>

    <!-- 学院表格操作按钮 -->
    <script type="text/html" id="collegeTableBar">
        <div class="layui-btn-group">
            <button class="layui-btn layui-btn-xs" lay-event="view">
                <i class="layui-icon">&#xe63c;</i> 查看
            </button>
            <button class="layui-btn layui-btn-xs layui-btn-warm" lay-event="edit">
                <i class="layui-icon">&#xe642;</i> 编辑
            </button>
        </div>
    </script>

    <!-- 教师表格操作按钮 -->
    <script type="text/html" id="teacherTableBar">
        <div class="layui-btn-group">
            <button class="layui-btn layui-btn-xs" lay-event="view">
                <i class="layui-icon">&#xe63c;</i> 查看
            </button>
            <button class="layui-btn layui-btn-xs layui-btn-warm" lay-event="edit">
                <i class="layui-icon">&#xe642;</i> 编辑
            </button>
        </div>
    </script>

    <!-- 状态显示模板 -->
    <script type="text/html" id="statusTpl">
        {{# if(d.status === 'active'){ }}
        <span class="layui-badge layui-bg-green">正常</span>
        {{# } else if(d.status === 'pending'){ }}
        <span class="layui-badge layui-bg-orange">待审核</span>
        {{# } else if(d.status === 'suspended'){ }}
        <span class="layui-badge layui-bg-gray">已停用</span>
        {{# } }}
    </script>

    <script src="/static/layui/layui.js"></script>
    <script>
    layui.use(['table', 'form', 'layer'], function(){
        var table = layui.table;
        var form = layui.form;
        var layer = layui.layer;
        
        // 获取学校ID
        var schoolId = {$school.id};
        
        // 渲染学院表格
        var collegeTable = table.render({
            elem: '#collegeTable',
            url: '/admin/college/index',
            where: {school_id: schoolId},
            page: true,
            cols: [[
                {field: 'id', title: 'ID', width: 80, sort: true},
                {field: 'name', title: '学院名称', width: 200},
                {field: 'code', title: '学院代码', width: 120},
                {field: 'dean', title: '院长', width: 100},
                {field: 'phone', title: '联系电话', width: 150},
                {field: 'status', title: '状态', width: 100, templet: '#statusTpl'},
                {field: 'teacher_count', title: '教师数', width: 100, align: 'center'},
                {field: 'create_time', title: '创建时间', width: 180},
                {title: '操作', width: 150, align: 'center', toolbar: '#collegeTableBar'}
            ]],
            limits: [10, 20, 50],
            limit: 10
        });
        
        // 渲染教师表格
        var teacherTable = table.render({
            elem: '#teacherTable',
            url: '/admin/teacher/index',
            where: {school_id: schoolId},
            page: true,
            cols: [[
                {field: 'id', title: 'ID', width: 80, sort: true},
                {field: 'real_name', title: '姓名', width: 100},
                {field: 'email', title: '邮箱', width: 200},
                {field: 'phone', title: '手机号', width: 150},
                {field: 'college_name', title: '所属学院', width: 150},
                {field: 'title', title: '职称', width: 100},
                {field: 'status', title: '状态', width: 100, templet: '#statusTpl'},
                {field: 'create_time', title: '创建时间', width: 180},
                {title: '操作', width: 150, align: 'center', toolbar: '#teacherTableBar'}
            ]],
            limits: [10, 20, 50],
            limit: 10
        });
        
        // 监听学院表格工具条
        table.on('tool(collegeTable)', function(obj){
            var data = obj.data;
            if (obj.event === 'view') {
                layer.open({
                    type: 2,
                    title: '学院详情',
                    area: ['800px', '600px'],
                    content: '/admin/college/view?id=' + data.id
                });
            } else if (obj.event === 'edit') {
                layer.open({
                    type: 2,
                    title: '编辑学院',
                    area: ['600px', '500px'],
                    content: '/admin/college/edit?id=' + data.id
                });
            }
        });
        
        // 监听教师表格工具条
        table.on('tool(teacherTable)', function(obj){
            var data = obj.data;
            if (obj.event === 'view') {
                layer.open({
                    type: 2,
                    title: '教师详情',
                    area: ['800px', '600px'],
                    content: '/admin/teacher/view?id=' + data.id
                });
            } else if (obj.event === 'edit') {
                layer.open({
                    type: 2,
                    title: '编辑教师',
                    area: ['600px', '500px'],
                    content: '/admin/teacher/edit?id=' + data.id
                });
            }
        });
    });
    </script>
</body>
</html> 