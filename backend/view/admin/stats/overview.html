{extend name="common/base" /}

{block name="title"}统计概览{/block}

{block name="content"}
<div class="layui-fluid">
    <div class="layui-row layui-col-space15">
        <!-- 统计卡片 -->
        <div class="layui-col-md3">
            <div class="layui-card">
                <div class="layui-card-header">
                    <i class="layui-icon layui-icon-user"></i> 用户总数
                </div>
                <div class="layui-card-body">
                    <h2>{$stats.user_count}</h2>
                    <p>今日新增：{$stats.today_users}</p>
                </div>
            </div>
        </div>
        
        <div class="layui-col-md3">
            <div class="layui-card">
                <div class="layui-card-header">
                    <i class="layui-icon layui-icon-file"></i> 文章总数
                </div>
                <div class="layui-card-body">
                    <h2>{$stats.article_count}</h2>
                    <p>分类：{$stats.category_count} | 标签：{$stats.tag_count}</p>
                </div>
            </div>
        </div>
        
        <div class="layui-col-md3">
            <div class="layui-card">
                <div class="layui-card-header">
                    <i class="layui-icon layui-icon-group"></i> 管理员
                </div>
                <div class="layui-card-body">
                    <h2>{$stats.admin_count}</h2>
                    <p>系统管理员数量</p>
                </div>
            </div>
        </div>
        
        <div class="layui-col-md3">
            <div class="layui-card">
                <div class="layui-card-header">
                    <i class="layui-icon layui-icon-chart"></i> 访问量
                </div>
                <div class="layui-card-body">
                    <h2>{$stats.today_visits}</h2>
                    <p>本月：{$stats.month_visits}</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="layui-row layui-col-space15">
        <!-- 用户趋势图 -->
        <div class="layui-col-md6">
            <div class="layui-card">
                <div class="layui-card-header">用户注册趋势</div>
                <div class="layui-card-body">
                    <div id="userTrendChart" style="height: 300px;"></div>
                </div>
            </div>
        </div>
        
        <!-- 文章趋势图 -->
        <div class="layui-col-md6">
            <div class="layui-card">
                <div class="layui-card-header">文章发布趋势</div>
                <div class="layui-card-body">
                    <div id="articleTrendChart" style="height: 300px;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="layui-row layui-col-space15">
        <!-- 访问趋势图 -->
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">访问量趋势</div>
                <div class="layui-card-body">
                    <div id="visitTrendChart" style="height: 300px;"></div>
                </div>
            </div>
        </div>
    </div>
</div>
{/block}

{block name="script"}
<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
<script>
layui.use(['layer'], function(){
    var layer = layui.layer;
    
    // 用户趋势图
    var userTrendChart = echarts.init(document.getElementById('userTrendChart'));
    var userTrendOption = {
        tooltip: {
            trigger: 'axis'
        },
        xAxis: {
            type: 'category',
            data: {$chartData.user_trend|json_encode|raw}
        },
        yAxis: {
            type: 'value'
        },
        series: [{
            data: {$chartData.user_trend|json_encode|raw},
            type: 'line',
            smooth: true
        }]
    };
    userTrendChart.setOption(userTrendOption);
    
    // 文章趋势图
    var articleTrendChart = echarts.init(document.getElementById('articleTrendChart'));
    var articleTrendOption = {
        tooltip: {
            trigger: 'axis'
        },
        xAxis: {
            type: 'category',
            data: {$chartData.article_trend|json_encode|raw}
        },
        yAxis: {
            type: 'value'
        },
        series: [{
            data: {$chartData.article_trend|json_encode|raw},
            type: 'line',
            smooth: true
        }]
    };
    articleTrendChart.setOption(articleTrendOption);
    
    // 访问趋势图
    var visitTrendChart = echarts.init(document.getElementById('visitTrendChart'));
    var visitTrendOption = {
        tooltip: {
            trigger: 'axis'
        },
        xAxis: {
            type: 'category',
            data: {$chartData.visit_trend|json_encode|raw}
        },
        yAxis: {
            type: 'value'
        },
        series: [{
            data: {$chartData.visit_trend|json_encode|raw},
            type: 'line',
            smooth: true
        }]
    };
    visitTrendChart.setOption(visitTrendOption);
    
    // 响应式处理
    window.addEventListener('resize', function() {
        userTrendChart.resize();
        articleTrendChart.resize();
        visitTrendChart.resize();
    });
});
</script>
{/block} 